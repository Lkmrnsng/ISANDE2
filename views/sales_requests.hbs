<div class="dashboard-container">
    <div class="requests-container">
        <!-- All Requests Section -->
        <section class="all-requests">
            <h2>All Requests</h2>
            <div class="summary-cards">
                <div class="card">Delivered This Week: <h1>{{stats.delivered}}</h1></div>
                <div class="card">Top Produce Sold: <h1>{{stats.topProduce}}</h1></div>
                <div class="card">Pending Requests: <h1>{{stats.pendingRequests}}</h1> </div>
                <div class="card">Average Order Value: <h1>₱{{format_number stats.averageOrder}}</h1></div>
            </div>
            <div class="controls">
                <select id="statusFilter" onchange="filterRequests()">
                    <option value="all">All Status</option>
                    <option value="Received">Status: Received</option>
                    <option value="Negotiation">Status: Negotiation</option>
                    <option value="Approved">Status: Approved</option>
                </select>
                <select id="sortByRequest" onchange="sortRequests()">
                    <option value="none">Sort by</option>
                    <option value="idAsc">ID Ascending</option>
                    <option value="idDesc">ID Descending</option>
                    <option value="dateAsc">Date Ascending</option>
                    <option value="dateDesc">Date Descending</option>
                </select>
            </div>
            <button onclick="cancelRequests()">Cancel Request/s</button>
            <table id="requestsTable">
            <thead>
                <tr>
                <th><input type="checkbox" id="hidden-checkbox"></th>
                <th>Request ID</th>
                <th>SustainaPartner</th>
                <th>Status</th>
                <th>Date/s</th>
                </tr>
            </thead>
            <tbody>
                {{#each requests}}
                <tr>
                <td><input type="checkbox"></td>
                <td>{{this.requestID}}</td>
                <td>{{this.partner}}</td>
                <td>{{this.status}}</td>
                <td>{{this.dates}}</td>
                </tr>
                {{/each}}
            </tbody>
            </table>
            <div class="pagination">
            <p>Click on a request to view its details</p>
                <span>Page <span id="currentPage">1</span> of <span id="totalPages">1</span></span>
                <div class="navigation-buttons">
                    <button id="prevRequest" class="nav-button" onclick="changePage(-1)">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m15 18-6-6 6-6"/></svg>
                    </button>
                    <button id="nextRequest" class="nav-button" onclick="changePage(1)">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m9 18 6-6-6-6"/></svg>
                    </button>
                </div>
            </div>
        </section>

        <!-- Request Details Section -->
        <aside class="request-details">
            <h2>Request Details</h2>
            <div class="item-list">
            {{#each selectedRequest.items}}
            <div class="item">
                <div class="placeholder-image"></div>
                <p>{{this.name}}</p>
                <p>{{this.quantity}} kg</p>
                <p>₱{{this.price}}</p>
            </div>
            {{/each}}
            </div>

            <div class="summary">
                <div class="summary-details">
                    <p>Request Total:</p>
                    <p class="attribute" id="request-total">₱0.00</p>
                </div>
                <div class="summary-details">
                    <p>Status:</p>
                    <p class="attribute" id="request-status">Unknown</p>
                </div>
            <button>View In Chat</button> <!-- TODO: Need help making this button redirect to the specific customer -->
            </div>
        </aside>
    </div>

  <!-- SustainaPartners Section -->
  <section class="sustaina-partners">
    <h2>SustainaPartners</h2>
    <div class="controls">
        <div class="filters">
            <select id="sortByPartner" onchange="sortPartners()">
                <option value="none">Sort by</option>
                <option value="idAsc">ID Ascending</option>
                <option value="idDesc">ID Descending</option>
                <option value="totalAsc">Total Ascending</option>
                <option value="totalDesc">Total Descending</option>
            </select>
        </div>
    </div>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Point Person</th>
          {{!-- <th>Location</th> --}}
          <th>Total Reqs</th>
          {{!-- <th>Avg. Weekly Reqs</th> --}}
          <th>Cancel Rate</th>
          {{!-- <th>Client Since</th> --}}
          <th>Contact</th>
        </tr>
      </thead>
      <tbody>
        {{#each partners}}
        <tr>
          <td>{{this.name}}</td>
          <td>{{this.pointPerson}}</td>
          {{!-- <td>{{this.location}}</td> --}}
          <td>{{this.totalReqs}}</td>
          {{!-- <td>{{this.avgWeeklyReqs}}</td> --}}
          <td>{{this.cancelRate}}</td>
          {{!-- <td>{{this.clientSince}}</td> --}}
          <td><button>Contact</button></td> <!-- TODO: Need help making this button redirect to the specific customer. this.userID should give you their uid -->
        </tr>
        {{/each}}
      </tbody>
    </table>
    <div class="pagination">
        <p>Click on a partner to view its details</p>
        <span>Page <span id="currentPartnerPage">1</span> of <span id="totalPartnerPages">1</span></span>
        <div class="navigation-buttons">
            <button id="prevPartner" class="nav-button" onclick="changePartnerPage(-1)">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m15 18-6-6 6-6"/></svg>
            </button>
            <button id="nextPartner" class="nav-button" onclick="changePartnerPage(1)">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m9 18 6-6-6-6"/></svg>
            </button>
        </div>
    </div>
  </section>
</div>

<script src="/js/sales-requests.js"></script>